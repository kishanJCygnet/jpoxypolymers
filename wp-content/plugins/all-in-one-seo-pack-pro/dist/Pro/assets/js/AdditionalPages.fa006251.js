var b=Object.defineProperty,w=Object.defineProperties;var C=Object.getOwnPropertyDescriptors;var g=Object.getOwnPropertySymbols;var k=Object.prototype.hasOwnProperty,S=Object.prototype.propertyIsEnumerable;var h=(e,s,t)=>s in e?b(e,s,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[s]=t,o=(e,s)=>{for(var t in s||(s={}))k.call(s,t)&&h(e,t,s[t]);if(g)for(var t of g(s))S.call(s,t)&&h(e,t,s[t]);return e},n=(e,s)=>w(e,C(s));import{c as v,a as c}from"./index.6b238922.js";import{j as x,c as L,k as d,i as f}from"./index.621c7f0d.js";import"./default-i18n.abde8d59.js";import{B as R}from"./Datepicker.f200b97a.js";import{C as D}from"./Index.021930ae.js";import{C as P}from"./Modal.d9bbc93c.js";import{S as A}from"./Close.5e7bcb70.js";import{S as $}from"./Exclamation.356738ce.js";import{n as _}from"./vueComponentNormalizer.87056a83.js";import{C as T}from"./Table.6d0adc12.js";import{C as U}from"./Card.56d6b098.js";import{C as M}from"./Tooltip.3ec20ff5.js";import{S as F}from"./Trash.214b5744.js";import"./isArrayLikeObject.86537e3d.js";import"./client.94d919c5.js";import"./_commonjsHelpers.f40d732e.js";import"./constants.feea4720.js";import"./NewsChannel.fc0a5ed5.js";import"./Slide.f5d21606.js";import"./QuestionMark.83ebd18e.js";var I="images/import-from-csv.fa7a7c61.png",O=function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("div",{staticClass:"additional-pages-input",class:{"in-table":e.inTable}},[e.inTable?e._e():t("div",{staticClass:"page-input-header"},[t("div",{staticClass:"page-url"},[e._v(e._s(e.strings.pageUrl))]),t("div",{staticClass:"page-priority"},[e._v(e._s(e.strings.priority))]),t("div",{staticClass:"page-frequency"},[e._v(e._s(e.strings.frequency))]),t("div",{staticClass:"page-last-modified"},[e._v(e._s(e.strings.lastModified))])]),t("div",{staticClass:"page-row"},[t("div",{staticClass:"page-url"},[t("base-input",{class:this.errors.url.invalid&&"aioseo-error"||this.page.url&&this.errors.url.exists&&"aioseo-warning"||this.page.url&&"aioseo-active",attrs:{value:e.page.url,size:"medium",placeholder:e.strings.placeholder},on:{keyup:function(i){return e.editPage("url",i.target.value)}},scopedSlots:e._u([{key:"append-icon",fn:function(){return[t("div",{staticClass:"append-icon"},[e.isLoading?e._e():[e.errors.url.invalid?t("svg-circle-close"):e._e(),!e.errors.url.invalid&&!e.errors.url.exists&&e.page.url?t("svg-circle-check"):e._e(),e.errors.url.exists&&e.page.url?t("svg-circle-exclamation"):e._e()]],2)]},proxy:!0}])}),this.errors.url.invalid?t("core-alert",{attrs:{type:"red",size:"small"}},[e._v(" "+e._s(e.strings.errors.url.invalid)+" ")]):e._e(),this.errors.url.exists?t("core-alert",{attrs:{type:"yellow",size:"small"}},[e._v(" "+e._s(e.strings.errors.url.exists)+" ")]):e._e()],1),t("div",{staticClass:"page-priority"},[t("base-select",{attrs:{size:"medium",value:e.page.priority,options:e.$constants.PRIORITY_OPTIONS},on:{input:function(i){return e.editPage("priority",i)}}})],1),t("div",{staticClass:"page-frequency"},[t("base-select",{attrs:{size:"medium",value:e.page.frequency,options:e.$constants.FREQUENCY_OPTIONS},on:{input:function(i){return e.editPage("frequency",i)}}})],1),t("div",{staticClass:"page-last-modified"},[t("base-datepicker",{attrs:{size:"medium",value:e.page.lastModified},on:{input:function(i){return e.editPage("lastModified",i)}}})],1)]),t("div",{staticClass:"page-input-footer"},[e.inTable?t("div",[t("base-button",{attrs:{type:"blue",size:"medium",disabled:e.errors.url.invalid||e.errors.url.exists||!e.page.url},on:{click:function(i){return e.updatePage(e.index)}}},[e._v(" "+e._s(e.strings.saveChanges)+" ")]),t("base-button",{attrs:{type:"gray",size:"medium"},on:{click:function(i){return e.$emit("cancel",!0)}}},[e._v(" "+e._s(e.strings.cancel)+" ")])],1):e._e(),e.inTable?e._e():t("div",[t("base-button",{attrs:{type:"blue",size:"small-table",disabled:e.errors.url.invalid||e.errors.url.exists||!e.page.url},on:{click:e.addPage}},[e._v(" "+e._s(e.strings.addPage)+" ")]),t("base-button",{attrs:{type:"black",size:"small-table"},on:{click:function(i){e.showImportModal=!0}}},[e._v(" "+e._s(e.strings.importFromCSV)+" ")])],1)]),e.showImportModal?t("core-modal",{on:{close:e.closeImportModal},scopedSlots:e._u([{key:"headerTitle",fn:function(){return[e._v(" "+e._s(e.strings.importAdditionalPages)+" ")]},proxy:!0},{key:"body",fn:function(){return[t("div",{staticClass:"aioseo-modal-body import-additional-pages"},[t("div",{staticClass:"alert"},[t("p",{domProps:{innerHTML:e._s(e.strings.modalDescription)}}),t("a",{attrs:{download:"aioseo-additional-pages-sample.csv",href:"data:text/csv;charset=utf-8,"+e.sampleCSVData}},[e._v(" "+e._s(e.strings.downloadSampleFile)+" ")])]),t("img",{attrs:{src:e.$getImgUrl(e.CSVFileImage),alt:e.strings.imgAltText}}),e.errors.upload?t("core-alert",{staticClass:"import-error",attrs:{type:"red"}},[t("svg-circle-close"),e._v(" "+e._s(e.errors.upload)+" ")],1):e._e(),t("div",{staticClass:"file-upload"},[t("base-input",{class:{"aioseo-error":e.errors.upload},attrs:{size:"medium",placeholder:e.strings.fileUploadPlaceholder},on:{focus:e.triggerFileUpload},model:{value:e.filename,callback:function(i){e.filename=i},expression:"filename"}}),t("base-button",{attrs:{type:"black",size:"medium"}},[e._v(" "+e._s(e.strings.chooseAFile)+" "),t("base-input",{ref:"file",attrs:{type:"file"},on:{click:e.reset,change:e.handleFileUpload},model:{value:e.inputFile,callback:function(i){e.inputFile=i},expression:"inputFile"}})],1)],1),t("base-button",{staticClass:"import",attrs:{type:"blue",size:"medium",disabled:!e.file||!e.importValidated,loading:e.loading},on:{click:e.submitFile}},[e._v(" "+e._s(e.strings.import)+" ")])],1)]},proxy:!0}],null,!1,3663470522)}):e._e()],1)},q=[];const u={page:{url:null,priority:{label:"0.7",value:"0.7"},frequency:{label:"weekly",value:"weekly"},lastModified:x().format("MM/DD/YYYY")}},V={components:{BaseDatepicker:R,CoreAlert:D,CoreModal:P,SvgCircleCheck:L,SvgCircleClose:A,SvgCircleExclamation:$},data(){return{CSVFileImage:I,priorityOptionsValues:[],frequencyOptionsValues:[],inputFile:null,filename:null,file:null,loading:!1,showImportModal:!1,page:d(u.page),errors:{url:{invalid:null,exists:null},upload:!1},isLoading:!1,strings:{placeholder:this.$t.sprintf("Enter a page URL, e.g. %1$s",`${this.$aioseo.urls.home}/new-page`),pageUrl:"Page URL",priority:"Priority",frequency:"Frequency",lastModified:"Last Modified",addPage:"Add Page",importFromCSV:"Import from CSV",saveChanges:"Save Changes",cancel:"Cancel",importAdditionalPages:"Import Additional Pages",modalDescription:this.$t.sprintf("You can import additional page URL's to your sitemap using a CSV file. The following 4 columns are required: %1$sPage URL, Priority, Frequency, Date Modified.%2$s","<strong>","</strong>"),downloadSampleFile:"Download Sample CSV File",imgAltText:"CSV example file",fileUploadPlaceholder:"Import from CSV file...",chooseAFile:"Choose a File",import:"Import",csvFileTypeRequired:"The file that you've currently selected is not a CSV file.",invalidCSV:"Unable to read CSV file. Please check if the file is valid and try again.",errors:{url:{invalid:"Please enter a valid URL.",exists:"URL already exists."}}},sampleCSVData:`Page URL,Priority,Frequency,Date Modified\r
https://aioseo.com/pricing/,0.0,weekly,01/30/2022`}},methods:n(o({},v(["updateAdditionalPages"])),{addPage(){const e=[...this.pages];e.unshift(JSON.stringify(this.page)),this.updateAdditionalPages(e),this.page=d(u.page),this.errors.url.invalid=null,this.$emit("process-page-add-and-update")},editPage(e,s){if(this.$set(this.page,e,s),!f(this.page.url)&&this.page.url){this.errors.url.invalid=!0;return}if(this.pageExists(this.page.url)&&!this.inTable){this.errors.url.invalid=!1,this.errors.url.exists=!0;return}this.errors.url.invalid=!1,this.errors.url.exists=!1,this.inTable&&this.$emit("process-page-edit",this.page)},updatePage(e){const s=[...this.pages];s[this.getPaginatedIndex(e)]=JSON.stringify(this.page),this.updateAdditionalPages(s),this.$emit("process-page-add-and-update"),this.$emit("cancel",!0)},pageExists(e){return this.getParsedPages().some(({url:s})=>s===e)},reset(){this.errors.upload=!1,this.filename=null,this.file=null,this.inputFile=null},triggerFileUpload(){this.reset(),this.$refs.file.$el.querySelector("input").focus(),this.$refs.file.$el.querySelector("input").click()},async submitFile(){this.loading=!0;try{const e=await this.parseFile(),s=this.pages;e.forEach(t=>{const i=this.prepareAdditionalPage(t);i&&s.unshift(JSON.stringify(i))}),this.updateAdditionalPages(s)}catch{this.errors.upload=this.strings.invalidCSV}this.reset(),this.page=d(u.page),this.showImportModal=!1,this.loading=!1},prepareAdditionalPage(e){const s=d(u.page);return e.forEach(t=>{if(f(t)&&!this.pageExists(t)){s.url=t;return}if(this.priorityOptionsValues.includes(t)){s.priority.label=s.priority.value=t;return}if(this.frequencyOptionsValues.includes(t.toLowerCase())){s.frequency.label=s.frequency.value=t.toLowerCase();return}isNaN(Date.parse(t))||(s.lastModified=t)}),s.url!==null?s:!1},parseFile(){const e=new FileReader;return e.readAsText(this.file),new Promise((s,t)=>{e.onerror=()=>{e.abort(),t(new DOMException)},e.onload=()=>{const a=e.result.split(/[\r\n]/).map(l=>l.split(","));s(a)}})},handleFileUpload(){this.reset(),this.file=this.$refs.file.$el.querySelector("input").files[0],this.file&&(this.filename=this.file.name,this.file.type!=="text/csv"&&(this.errors.upload=this.strings.csvFileTypeRequired))},closeImportModal(){this.reset(),this.showImportModal=!1}}),computed:n(o({},c({pages:e=>e.options.sitemap.general.additionalPages.pages})),{importValidated(){return this.file.type==="text/csv"}}),props:{inTable:Boolean,row:Object,index:Number,getPaginatedIndex:Function,getParsedPages:Function,rowPage:{type:Object,default(){return{}}},editedPage:{type:Object,default(){return{}}}},mounted(){this.priorityOptionsValues=this.$constants.PRIORITY_OPTIONS.map(e=>e.value),this.frequencyOptionsValues=this.$constants.FREQUENCY_OPTIONS.map(e=>e.value),this.inTable&&(this.page=this.rowPage!==this.editedPage?this.rowPage:this.editedPage)}},m={};var N=_(V,O,q,!1,E,null,null,null);function E(e){for(let s in m)this[s]=m[s]}var z=function(){return N.exports}(),Y=function(){var e=this,s=e.$createElement,t=e._self._c||s;return e.options.sitemap.general.enable?t("core-card",{attrs:{slug:"additionalPages",toggles:e.options.sitemap.general.additionalPages.enable},scopedSlots:e._u([{key:"header",fn:function(){return[t("base-toggle",{model:{value:e.options.sitemap.general.additionalPages.enable,callback:function(i){e.$set(e.options.sitemap.general.additionalPages,"enable",i)},expression:"options.sitemap.general.additionalPages.enable"}}),e._v(" "+e._s(e.strings.additionalPages)+" ")]},proxy:!0},{key:"tooltip",fn:function(){return[e._v(" "+e._s(e.strings.additionalPagesTooltip)+" ")]},proxy:!0}],null,!1,3239716698)},[t("div",{staticClass:"aioseo-additional-pages"},[t("AddAdditionalPage",{attrs:{getPaginatedIndex:e.getPaginatedIndex,getParsedPages:e.getParsedPages},on:{"process-page-add-and-update":e.processPageAddAndUpdate}}),t("core-wp-table",{key:e.tableKey,ref:"table",staticClass:"additional-pages-table",attrs:{columns:e.columns,rows:e.rows,totals:e.totals,loading:e.wpTableLoading,initialPageNumber:1,showSearch:e.showSearch,bulkOptions:e.bulkOptions,"search-label":e.strings.searchUrls},on:{"process-bulk-action":e.processBulkAction,paginate:e.processPagination,search:e.processSearch},scopedSlots:e._u([{key:"url",fn:function(i){var a=i.row,l=i.index,p=i.editRow;return[t("a",{staticClass:"post-title",attrs:{href:"#"},on:{click:function(r){return r.preventDefault(),r.stopPropagation(),p(l)}}},[e._v(" "+e._s(a.url)+" ")]),t("div",{staticClass:"row-actions"},[t("span",[t("a",{staticClass:"edit",attrs:{href:"#"},on:{click:function(r){return r.preventDefault(),r.stopPropagation(),p(l)}}},[t("span",[e._v(e._s(e.strings.edit))])]),e._v(" | ")]),t("span",[t("a",{staticClass:"delete",attrs:{href:"#"},on:{click:function(r){return r.preventDefault(),r.stopPropagation(),e.maybeProcessDelete(a.url)}}},[t("span",[e._v(e._s(e.strings.delete))])])])])]}},{key:"edit-row",fn:function(i){var a=i.index,l=i.editRow;return[t("AddAdditionalPage",{attrs:{index:a,rowPage:e.rowPage(a),editedPage:e.editedPage,getPaginatedIndex:e.getPaginatedIndex,getParsedPages:e.getParsedPages,inTable:""},on:{cancel:function(p){return l(null)},"process-page-add-and-update":e.processPageAddAndUpdate,"process-page-edit":e.processPageEdit}})]}},{key:"page-actions",fn:function(i){var a=i.row;return[t("div",{staticClass:"page-actions"},[t("core-tooltip",{attrs:{type:"action"},scopedSlots:e._u([{key:"tooltip",fn:function(){return[e._v(" "+e._s(e.strings.delete)+" ")]},proxy:!0}],null,!0)},[t("svg-trash",{nativeOn:{click:function(l){return e.maybeProcessDelete(a.url)}}})],1)],1)]}}],null,!1,1595044912)}),e.showDeleteModal?t("core-modal",{attrs:{"no-header":""},scopedSlots:e._u([{key:"body",fn:function(){return[t("div",{staticClass:"aioseo-modal-body delete"},[t("button",{staticClass:"close",on:{click:function(i){i.stopPropagation(),e.showDeleteModal=!1}}}),t("h3",[e._v(e._s(e.areYouSureDeleteLink))]),t("div",{staticClass:"reset-description"},[e._v(" "+e._s(e.strings.thisWillRemoveLink)+" ")]),t("base-button",{attrs:{type:"blue",size:"medium",loading:e.deletingRow},on:{click:e.processPageDelete}},[e._v(" "+e._s(e.yesDeleteLink)+" ")]),t("base-button",{attrs:{type:"gray",size:"medium"},on:{click:function(i){e.showDeleteModal=!1}}},[e._v(" "+e._s(e.strings.noChangedMind)+" ")])],1)]},proxy:!0}],null,!1,3154880166)}):e._e()],1)]):e._e()},W=[];const j={components:{AddAdditionalPage:z,CoreWpTable:T,CoreCard:U,CoreTooltip:M,CoreModal:P,SvgTrash:F},data(){return{page:{},editedPage:{},resultsPerPage:10,searchResults:null,searchTerm:null,deletingRow:!1,tableKey:0,activeRow:-1,pageNumber:1,wpTableLoading:!1,showSearch:!0,showPagination:!0,showDeleteModal:!1,shouldDeleteURL:null,selectedRows:null,bulkOptions:[{label:"Delete",value:"delete"}],strings:{placeholder:this.$t.sprintf("Enter a page URL, e.g. %1$s",`${this.$aioseo.urls.home}/new-page`),pageUrl:"Page URL",priority:"Priority",frequency:"Frequency",lastModified:"Last Modified",searchUrls:"Search URLs",edit:"Edit",delete:"Delete",addPage:"Add Page",importFromCSV:"Import from CSV",always:"always",additionalPages:"Additional Pages",additionalPagesTooltip:"You can use this section to add any URLs to your sitemap which aren't a part of your WordPress installation. For example, if you have a contact form that you would like to be included on your sitemap you can enter the information manually.",areYouSureDeleteLink:"Are you sure you want to delete this page?",areYouSureDeleteLinks:"Are you sure you want to delete these pages?",thisWillRemoveLink:"This will permanently remove this page from the additional pages sitemap.",thisWillRemoveLinks:"This will permanently remove the selected pages from the additional pages sitemap.",yesDeleteLink:"Delete Page",yesDeleteLinks:"Delete Selected Pages",noChangedMind:"No, I changed my mind"}}},computed:n(o(o({},c(["options","additionalPages"])),c({pages:e=>e.options.sitemap.general.additionalPages.pages})),{currentPages(){return this.searchResults||this.getParsedPages()},rows(){const e=this.currentPages.map(t=>({url:t.url,priority:t.priority&&t.priority.label?t.priority.label:"",frequency:t.frequency&&t.frequency.label?t.frequency.label:"",lastModified:t.lastModified})),s=this.pageNumber===1?0:(this.pageNumber-1)*this.resultsPerPage;return e.slice(s,s+this.resultsPerPage)},totals(){return{page:1,pages:Math.ceil(this.currentPages.length/this.resultsPerPage),total:this.currentPages.length}},columns(){return[{slug:"url",label:"Page URL"},{slug:"priority",label:"Priority",width:"90px"},{slug:"frequency",label:"Frequency",width:"90px"},{slug:"lastModified",label:"Last Modified",width:"110px"},{slug:"page-actions",label:"",width:"40px"}]},areYouSureDeleteLink(){return Array.isArray(this.shouldDeleteURL)?this.strings.areYouSureDeleteLinks:this.strings.areYouSureDeleteLink},yesDeleteLink(){return Array.isArray(this.shouldDeleteURL)?this.strings.yesDeleteLinks:this.strings.yesDeleteLink},thisWillRemoveLink(){return Array.isArray(this.shouldDeleteURL)?this.strings.thisWillRemoveLinks:this.strings.thisWillRemoveLink}}),methods:n(o({},v(["updateAdditionalPages"])),{processSearch(e){if(this.$refs.table.editRow(null),this.pageNumber=1,e===""){this.searchResults=null,this.searchTerm=null;return}e||(e=this.searchTerm),this.wpTableLoading=!0,this.searchResults=this.getParsedPages().filter(s=>s.url.includes(e)),this.searchTerm=e,this.wpTableLoading=!1},processPagination(e){this.$refs.table.editRow(null),this.wpTableLoading=!0,this.pageNumber=e,this.wpTableLoading=!1},processBulkAction({action:e,selectedRows:s}){!s.length||e==="delete"&&(this.showDeleteModal=!0,this.shouldDeleteURL=s)},processPageDelete(){this.wpTableLoading=!0,Array.isArray(this.shouldDeleteURL)?this.shouldDeleteURL.forEach(e=>{this.deletePage(e)}):this.deletePage(this.shouldDeleteURL),this.showDeleteModal=!1,this.wpTableLoading=!1},deletePage(e){const s=[];this.getParsedPages().forEach(t=>{t.url!==e&&s.push(JSON.stringify(t))}),this.updateAdditionalPages(s),this.searchResults&&this.processSearch()},maybeProcessDelete(e){this.showDeleteModal=!0,this.shouldDeleteURL=e},processPageEdit(e){this.editedPage=e},processPageAddAndUpdate(){this.searchTerm&&this.processSearch(this.searchTerm)},rowPage(e){return this.searchResults?this.searchResults[this.getPaginatedIndex(e)]:this.getParsedPages()[this.getPaginatedIndex(e)]},getPaginatedIndex(e){return(this.pageNumber-1)*this.resultsPerPage+e},getParsedPages(){return this.pages.map(e=>JSON.parse(e))}})},y={};var B=_(j,Y,W,!1,J,null,null,null);function J(e){for(let s in y)this[s]=y[s]}var fe=function(){return B.exports}();export{fe as default};
