var d=Object.defineProperty;var m=(n,t,e)=>t in n?d(n,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):n[t]=e;var s=(n,t,e)=>(m(n,typeof t!="symbol"?t+"":t,e),e);import{s as a}from"./index.670b7e80.js";import{d as f,e as y,f as g,i as _}from"./helpers.1eef9d6b.js";import{a as h}from"./index.1a8da5ff.js";function w(){return new Worker(""+window.__aioseoDynamicImportPreload__("main.0e18c814.js"))}class S{constructor(){s(this,"postId",null);s(this,"postTitle",null);s(this,"postParsedTitle",null);s(this,"postParsedDescription",null);s(this,"postDescription",null);s(this,"keyphrases",null);s(this,"postContent",null);s(this,"postSlug",null);s(this,"isAnalyzing",!1);s(this,"worker",null)}async runAnalysis({postId:t,useSavedData:e=!1,postData:o={...a.state.currentPost},content:c=y(),slug:u=g()}){if(!a.state.options.advanced||!a.state.options.advanced.truSeo||!a.state.currentPost.page_analysis||this.isAnalyzing)return;this.worker&&this.worker.terminate();const p={separator:h(window.aioseo.options.searchAppearance.global.separator)},r={postId:t,useSavedData:e,postData:o,content:c,slug:u,postEditedTitle:f(),aioseo:window.aioseo,aioseoGlobals:p};let i=[];this.worker=new w,this.worker.addEventListener("message",l=>{l.data.event==="tru-seo-analysis-complete"&&(i=l.data.analysis,this.dispatchActions(i,r),this.worker.terminate())}),this.worker.postMessage({event:"tru-seo-analysis",analysisData:r})}setSidebarButtonScore(t){const e=document.getElementById("aioseo-post-settings-sidebar-button"),o=document.getElementById("aioseo-post-score");!e||!o||(e.className=80<t?"score-green":50<t?"score-orange":"score-red",_()||(e.classList.add("aioseo-score-button","classic-editor"),t=`${t}/100`),o.textContent=t)}dispatchActions(t,e){t.forEach(o=>{o.action==="updateState"&&window.aioseo.currentPost.postType!=="attachment"&&e.postEditedTitle&&this.setSidebarButtonScore(o.data.seo_score),a.dispatch(o.action,o.data)})}}export{S as T};
