var G=Object.defineProperty,J=Object.defineProperties;var Q=Object.getOwnPropertyDescriptors;var P=Object.getOwnPropertySymbols;var X=Object.prototype.hasOwnProperty,tt=Object.prototype.propertyIsEnumerable;var A=(t,s,e)=>s in t?G(t,s,{enumerable:!0,configurable:!0,writable:!0,value:e}):t[s]=e,d=(t,s)=>{for(var e in s||(s={}))X.call(s,e)&&A(t,e,s[e]);if(P)for(var e of P(s))tt.call(s,e)&&A(t,e,s[e]);return t},h=(t,s)=>J(t,Q(s));import{i as R,a as S}from"./context.0a0c6a10.js";import{C as _}from"./Tooltip.b5773cff.js";import{C as f}from"./Table.a478865a.js";import{a as k,b as et,c as st}from"./Affiliate.b51491f4.js";import{S as b}from"./Trash.12a3da09.js";import{n as u}from"./vueComponentNormalizer.4c221f82.js";import{j as w,p as U,a0 as nt}from"./vendor.f6bbc087.js";import{C as it}from"./Index.d771a71f.js";import{C as ot}from"./Tabs.d639cede.js";import{C as rt}from"./Modal.b51725b4.js";import{S as at,b as F}from"./index.0c09686e.js";import{B as lt}from"./Editor.aa430cd0.js";import{S as ut}from"./Pencil.d0705f77.js";import{T as j}from"./Slide.c8a2867c.js";import{S as K}from"./Plus.4a10b727.js";const l=t=>t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");var Ne={methods:{filteredSuggestionsOutbound(t){const s=t.links.suggestionsOutbound.rows,e=[];return s.forEach(n=>{this.editorIsSuggestionAlreadyAdded(n)||e.push(n)}),e},editorIsSuggestionAlreadyAdded(t){return R()?this.blockEditorIsSuggestionAlreadyAdded(t):S()?this.classicEditorIsSuggestionAlreadyAdded(t):!1},blockEditorIsSuggestionAlreadyAdded(t){const s=window.wp.data.select("core/block-editor").getBlocks();return s?this.doesBlockHaveLink(s,t):!1},doesBlockHaveLink(t,s){let e=!1;return t.forEach(n=>{e||!n.attributes||s.suggestions.forEach(i=>{const o=l(i.context.permalink.trim()),r=new RegExp(`(<a href="${o}"[^<>]*>)(.*)(</a[^<>]*>)`,"i");if(n.attributes.content&&n.attributes.content.search(r)!==-1){e=!0;return}if(!n.innerBlocks)return;this.doesBlockHaveLink(n.innerBlocks,s)&&(e=!0)})}),e},classicEditorIsSuggestionAlreadyAdded(t){let s="",e=null,n=null;if(document.querySelector("#wp-content-wrap.tmce-active")?(e=window.tinyMCE.get("content"),s=e.getContent({format:"raw"})):(n=document.querySelector("textarea#content"),s=n?n.value:""),!s)return!1;let i=!1;return t.suggestions.forEach(o=>{const r=l(o.context.permalink.trim()),a=new RegExp(`(<a href="${r}"[^<>]*>)(.*)(</a[^<>]*>)`,"i");s.search(a)!==-1&&(i=!0)}),i}}},z={methods:{findTargetBlock(t,s){const e=l(s);let n=null;return t.forEach(i=>{if(n||!i.attributes)return;if(i.attributes.content&&i.attributes.content.search(e)!==-1){n=i.clientId;return}if(!i.innerBlocks)return;const o=this.findTargetBlock(i.innerBlocks,s);o&&(n=o)}),n}}},$={mixins:[z],props:{post:{type:Object,required:!0},postIndex:{type:Number,required:!1},postId:{type:Number,required:!1},linksReport:{type:Boolean,default(){return!1}},postReport:{type:Boolean,default(){return!1}},metabox:{type:Boolean,default(){return!1}}},beforeMount(){this.$bus.$on("updatingLinks",t=>{this.wpTableLoading=t}),this.pageNumber=this.linkType?this.linkAssistant.postReport[this.linkType].totals.page:1},data(){return{tableKey:0,pageNumber:1,action:"",wpTableLoading:!1,showModal:!1,selectedRows:[],bulkOptions:[{label:"Delete",value:"delete"}],strings:{frontPage:"Front Page",viewPost:"View Post",editPost:"Edit Post",deleteLink:"Delete Link"},modalStrings:{areYouSureSingle:"Are you sure you want to delete this link?",areYouSureMultiple:"Are you sure you want to delete these links?",areYouSureAll:"Are you sure you want to delete all links?",actionCannotBeUndone:"This action cannot be undone.",yesSingle:"Yes, I want to delete this link",yesMultiple:"Yes, I want to delete these links",yesAll:"Yes, I want to delete all links",noChangedMind:"No, I changed my mind"}}},computed:h(d({},w(["linkAssistant","currentPost"])),{rows(){if(!this.metabox)return this.post.links[this.linkType].rows;const t=this.pageNumber===1?0:(this.pageNumber-1)*10;return this.post.links[this.linkType].rows.slice(t,t+10)}}),methods:h(d({},U("linkAssistant",["linkDelete","linksBulk","postReportPaginate","postSettingsUpdate"])),{openPostReport(t){window.location.href=`#/post-report?postId=${this.postId}&initialTab=${t}`},maybeDoBulkAction({action:t,selectedRows:s}){s===!1||!t||(this.action=t,this.selectedRows=s,this.showModal=!0)},doBulkAction(){if(this.showModal=!1,!(this.selectedRows===!1||typeof this.selectedRows=="undefined")){if(typeof this.selectedRows=="number"){this.doDeleteLink(this.selectedRows);return}if(this.metabox&&this.linkType!=="inboundInternal"){this.idsToIndexes(this.selectedRows).forEach(s=>{this.editorRemoveLink(s)});return}this.$bus.$emit("updatingLinks",!0),this.linksBulk({postIndex:this.postIndex,postId:this.post.ID||this.currentPost.id,action:this.action,linkType:this.linkType,linkIds:this.selectedRows,linksReport:this.linksReport,postReport:this.postReport}).finally(()=>{this.$bus.$emit("updatingLinks",!1),this.$emit("linksUpdated")})}},doDeleteLink(t){const s=this.post.links[this.linkType].rows[t].id;if(!!s){if(this.metabox&&this.linkType!=="inboundInternal"){this.editorRemoveLink(t);return}this.$bus.$emit("updatingLinks",!0),this.linkDelete({postIndex:this.postIndex,postId:this.post.ID||this.currentPost.id,linkId:s,linksReport:this.linksReport,postReport:this.postReport}).finally(()=>{this.$bus.$emit("updatingLinks",!1),this.$emit("linksUpdated")})}},processPagination(t){this.tableKey++,this.pageNumber=t,!this.metabox&&(this.$bus.$emit("updatingLinks",!0),this.postReportPaginate({page:t,postId:this.post.ID,postIndex:this.postIndex,type:this.linkType}).finally(()=>{this.$bus.$emit("updatingLinks",!1)}))},editorRemoveLink(t){R()&&(this.$bus.$emit("updatingLinks",!1),this.blockEditorRemoveLink(t),this.$bus.$emit("updatingLinks",!1)),S()&&this.classicEditorRemoveLink(t)},blockEditorRemoveLink(t){const s=this.currentPost.linkAssistant.links[this.linkType].rows[t];if(!s)return;this.$bus.$emit("updatingLinks",!0);const e=l(s.anchor.trim()),n=s.phrase_html.trim(),i=l(n),o=window.wp.data.select("core/block-editor").getBlocks(),r=this.findTargetBlock(o,n);if(!r){this.$bus.$emit("updatingLinks",!1);return}const a=window.wp.data.select("core/block-editor").getBlock(r);if(!a){this.$bus.$emit("updatingLinks",!1);return}let c=new RegExp(`(<t?a[^<>]*>)(.*)?(${e})(.*)?(</t?a[^<>]*>)`,"i");const p=n.replace(c,"$2$3$4");c=new RegExp(`${i}`,"i"),window.wp.data.dispatch("core/block-editor").updateBlockAttributes(r,{content:a.attributes.content.replace(c,p)}).then(()=>{this.$delete(this.post.links[this.linkType].rows,t)}).catch(v=>{console.error(`Couldn	 delete link with type "${this.linkType}" and index ${t}:`,v)}).finally(()=>{this.$bus.$emit("updatingLinks",!1),this.$emit("linksUpdated")})},classicEditorRemoveLink(t){const s=this.currentPost.linkAssistant.links[this.linkType].rows[t];if(!s||!window.tinyMCE)return;this.$bus.$emit("updatingLinks",!0);let e="",n=null,i=null;if(document.querySelector("#wp-content-wrap.tmce-active")?(n=window.tinyMCE.get("content"),e=n.getContent({format:"raw"})):(i=document.querySelector("textarea#content"),e=i?i.value:""),!e){this.$bus.$emit("updatingLinks",!1);return}let o=s.phrase_html.trim();n||(o=o.replace(/(\sdata-mce-href=".*")/gi,""));const r=l(s.anchor.trim());let a=new RegExp(`(<t?a[^<>]*>)(.*)?(${r})(.*)?(</t?a[^<>]*>)`,"i");const c=o.replace(a,"$2$3$4"),p=l(o);a=new RegExp(`${p}`,"i"),e=e.replace(a,c),n?n.setContent(e):i.value=e,this.$delete(this.post.links[this.linkType].rows,t),this.postSettingsUpdate({postContent:e}).finally(()=>{this.$bus.$emit("updatingLinks",!1),this.$emit("linksUpdated")})},idsToIndexes(t){let s,e=[];return Array.isArray(t)&&(s=t.map(Number)),s&&this.post.links[this.linkType].rows.forEach((n,i)=>{s.includes(n.id)&&e.push(i)}),t==="all"&&(e=this.post.links[this.linkType].rows.map((n,i)=>i)),e.sort(function(n,i){return i-n})}})},ct=function(){var t=this,s=t.$createElement,e=t._self._c||s;return t.showModal?e("core-modal",{staticClass:"aioseo-confirmation-modal",attrs:{"no-header":""},scopedSlots:t._u([{key:"body",fn:function(){return[e("div",{staticClass:"aioseo-modal-body"},[e("button",{staticClass:"close",on:{click:function(n){return n.stopPropagation(),t.$emit("closeModal",!0)}}},[e("svg-close",{on:{click:function(n){return t.$emit("closeModal",!0)}}})],1),e("h3",[t._v(t._s(t.areYouSure))]),e("div",{staticClass:"reset-description",domProps:{innerHTML:t._s(t.strings.actionCannotBeUndone)}}),e("base-button",{attrs:{type:"blue",size:"medium"},on:{click:function(n){return t.$emit("doBulkAction",n)}}},[t._v(" "+t._s(t.confirmation)+" ")]),e("base-button",{attrs:{type:"gray",size:"medium"},on:{click:function(n){return t.$emit("closeModal",!0)}}},[t._v(" "+t._s(t.strings.noChangedMind)+" ")])],1)]},proxy:!0}],null,!1,3343467816)}):t._e()},dt=[];const pt={components:{CoreModal:rt,SvgClose:at},props:{showModal:{type:Boolean,required:!0},selectedRows:{required:!0},strings:{type:Object,required:!0}},computed:{areYouSure(){return this.selectedRows==="all"?this.strings.areYouSureAll:Array.isArray(this.selectedRows)&&1<this.selectedRows.length?this.strings.areYouSureMultiple:this.strings.areYouSureSingle},confirmation(){return this.selectedRows==="all"?this.strings.yesAll:Array.isArray(this.selectedRows)&&1<this.selectedRows.length?this.strings.yesMultiple:this.strings.yesSingle}}},I={};var ht=u(pt,ct,dt,!1,gt,null,null,null);function gt(t){for(let s in I)this[s]=I[s]}var m=function(){return ht.exports}(),ft=function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("div",{staticClass:"aioseo-link-assistant-phrase",on:{mouseover:function(n){return t.$emit("mouseOver")},mouseleave:function(n){return t.$emit("mouseLeave")}}},[e("span",{staticClass:"phrase"},[e("span",{staticClass:"first"},[t._v(t._s(t.firstPart))]),t.tooltip?e("core-tooltip",{attrs:{type:"action"},scopedSlots:t._u([{key:"tooltip",fn:function(){return[e("a",{staticClass:"tooltip-url",attrs:{href:t.url,target:"_blank"}},[t._v(t._s(t.url))])]},proxy:!0}],null,!1,3985851943)},[e("span",{staticClass:"anchor",on:{click:t.maybeOpenLink}},[t._v(t._s(t.linkAnchor))])]):t._e(),t.tooltip?t._e():e("div",[e("span",{staticClass:"anchor"},[t._v(t._s(t.linkAnchor))])]),e("span",{staticClass:"last"},[t._v(t._s(t.lastPart))])],1),t._t("icons")],2)},kt=[];const mt={components:{CoreTooltip:_},props:{phrase:{type:String,required:!0},phraseHtml:{type:String,required:!0},anchor:{type:String,required:!0},url:{type:String,required:!0},tooltip:{type:Boolean,required:!1,default:!0},clickableAnchor:{type:Boolean,default(){return!1}}},computed:{partPattern(){const t=l(this.anchor);return new RegExp(`(.*)(<t?a[^>]*>.*${t}.*</t?a>)(.*)`,"i")},firstPart(){return this.stripTags(this.getPart(1))},linkAnchor(){return this.stripTags(this.getPart(2))},lastPart(){return this.stripTags(this.getPart(3))}},methods:{getPart(t){const s=this.phraseHtml.match(this.partPattern);return s?s[t]:""},stripTags(t){return t.replace(/(<([^>]+)>)/gi,"")},maybeOpenLink(){this.clickableAnchor&&window.open(this.url,"_blank").focus()}}},C={};var vt=u(mt,ft,kt,!1,_t,null,null,null);function _t(t){for(let s in C)this[s]=C[s]}var y=function(){return vt.exports}(),bt=function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("div",[e("core-wp-table",{key:t.tableKey,class:{"link-assistant-inner-table":!t.postReport},attrs:{columns:t.columns,rows:t.rows,totals:t.post.links.affiliate.totals,"bulk-options":t.bulkOptions,showSearch:!1,showPagination:!t.linksReport,showTableFooter:t.postReport,loading:t.wpTableLoading},on:{"process-bulk-action":t.maybeDoBulkAction,paginate:t.processPagination},scopedSlots:t._u([{key:"phrase",fn:function(n){var i=n.row;return[e("link-assistant-phrase",{attrs:{phrase:i.phrase,phraseHtml:i.phrase_html,anchor:i.anchor,url:i.url,clickableAnchor:!0}})]}},{key:"created",fn:function(n){var i=n.column;return[t._v(" "+t._s(t.$moment.utc(i).tz(t.$moment.tz.guess()).format("MMMM D, YYYY"))+" ")]}},{key:"delete",fn:function(n){var i=n.index;return[e("core-tooltip",{attrs:{type:"action"},scopedSlots:t._u([{key:"tooltip",fn:function(){return[t._v(" "+t._s(t.strings.deleteLink)+" ")]},proxy:!0}],null,!0)},[e("svg-trash",{nativeOn:{click:function(o){return t.maybeDoBulkAction({action:"delete",selectedRows:i})}}})],1)]}}])}),t.postReport?t._e():e("div",{staticClass:"links-bottom"},[e("div",{staticClass:"links-bottom-left"},[t.post.links.affiliate.totals.total>5&&t.postReport?e("div",[e("svg-link-external"),e("a",{staticClass:"link-view",attrs:{href:"#"},on:{click:function(n){return n.preventDefault(),t.openPostReport("affiliate")}}},[t._v(" "+t._s(t.seeAllLinks)+" ")])],1):t._e()]),e("div",{staticClass:"links-bottom-right"},[t.post.links.affiliate.rows.length?e("a",{staticClass:"link-delete",on:{click:function(n){return n.preventDefault(),t.maybeDoBulkAction({action:"delete",selectedRows:"all"})}}},[t._v(" "+t._s(t.strings.deleteAllLinks)+" ")]):t._e()])]),e("link-assistant-confirmation-modal",{attrs:{showModal:t.showModal,selectedRows:t.selectedRows,strings:t.modalStrings},on:{doBulkAction:t.doBulkAction,closeModal:function(n){t.showModal=!1}}})],1)},wt=[];const $t={components:{CoreTooltip:_,CoreWpTable:f,LinkAssistantConfirmationModal:m,LinkAssistantPhrase:y,SvgLinkExternal:k,SvgTrash:b},mixins:[$],data(){return{linkType:"affiliate",strings:{deleteAllLinks:this.$t.sprintf("Delete All %1$s Links","Affiliate")}}},computed:{columns(){return[{slug:"phrase",label:"Phrase"},{slug:"delete",width:"50px"}]},seeAllLinks(){return this.$t.sprintf("See All %1$s %2$s Links",this.post.links.affiliate.totals.total,"Affiliate")}}},T={};var yt=u($t,bt,wt,!1,xt,null,null,null);function xt(t){for(let s in T)this[s]=T[s]}var Ue=function(){return yt.exports}(),Rt=function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("div",[e("core-wp-table",{key:t.tableKey,class:{"link-assistant-inner-table":!t.postReport},attrs:{columns:t.columns,rows:t.rows,totals:t.post.links.external.totals,"bulk-options":t.bulkOptions,showSearch:!1,showPagination:!t.linksReport,showTableFooter:t.postReport,loading:t.wpTableLoading,initialPageNumber:t.pageNumber},on:{"process-bulk-action":t.maybeDoBulkAction,paginate:t.processPagination},scopedSlots:t._u([{key:"phrase",fn:function(n){var i=n.row;return[e("link-assistant-phrase",{attrs:{phrase:i.phrase,phraseHtml:i.phrase_html,anchor:i.anchor,url:i.url,clickableAnchor:!0}})]}},{key:"created",fn:function(n){var i=n.column;return[t._v(" "+t._s(t.$moment.utc(i).tz(t.$moment.tz.guess()).format("MMMM D, YYYY"))+" ")]}},{key:"delete",fn:function(n){var i=n.index;return[e("core-tooltip",{attrs:{type:"action"},scopedSlots:t._u([{key:"tooltip",fn:function(){return[t._v(" "+t._s(t.strings.deleteLink)+" ")]},proxy:!0}],null,!0)},[e("svg-trash",{nativeOn:{click:function(o){return t.maybeDoBulkAction({action:"delete",selectedRows:i})}}})],1)]}}])}),t.postReport?t._e():e("div",{staticClass:"links-bottom"},[e("div",{staticClass:"links-bottom-left"},[t.post.links.external.totals.total>5&&t.linksReport?e("div",[e("svg-link-external"),e("a",{staticClass:"link-view",attrs:{href:"#"},on:{click:function(n){return n.preventDefault(),t.openPostReport("external")}}},[t._v(" "+t._s(t.seeAllLinks)+" ")])],1):t._e()]),e("div",{staticClass:"links-bottom-right"},[t.post.links.external.rows.length?e("a",{staticClass:"link-delete",on:{click:function(n){return n.preventDefault(),t.maybeDoBulkAction({action:"delete",selectedRows:"all"})}}},[t._v(" "+t._s(t.strings.deleteAllLinks)+" ")]):t._e()])]),e("link-assistant-confirmation-modal",{attrs:{showModal:t.showModal,selectedRows:t.selectedRows,strings:t.modalStrings},on:{doBulkAction:t.doBulkAction,closeModal:function(n){t.showModal=!1}}})],1)},St=[];const Pt={components:{CoreTooltip:_,CoreWpTable:f,LinkAssistantConfirmationModal:m,LinkAssistantPhrase:y,SvgLinkExternal:k,SvgTrash:b},mixins:[$],data(){return{linkType:"external",strings:{deleteAllLinks:this.$t.sprintf("Delete All %1$s Links","External")}}},computed:{columns(){return[{slug:"phrase",label:"Phrase"},{slug:"delete",width:"50px"}]},seeAllLinks(){return this.$t.sprintf("See All %1$s %2$s Links",this.post.links.external.totals.total,"External")}}},L={};var At=u(Pt,Rt,St,!1,It,null,null,null);function It(t){for(let s in L)this[s]=L[s]}var Fe=function(){return At.exports}(),Ct=function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("svg",{staticClass:"aioseo-link-suggestion",attrs:{viewBox:"0 0 17 10",fill:"none",xmlns:"http://www.w3.org/2000/svg"}},[e("path",{attrs:{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M7.66699 7.43742H4.33366C2.95866 7.43742 1.83366 6.31242 1.83366 4.93742C1.83366 3.56242 2.95866 2.43742 4.33366 2.43742H7.66699V0.770752H4.33366C2.03366 0.770752 0.166992 2.63742 0.166992 4.93742C0.166992 7.23742 2.03366 9.10408 4.33366 9.10408H7.66699V7.43742ZM12.667 0.770752H9.33366V2.43742H12.667C14.042 2.43742 15.167 3.56242 15.167 4.93742C15.167 6.31242 14.042 7.43742 12.667 7.43742H9.33366V9.10408H12.667C14.967 9.10408 16.8337 7.23742 16.8337 4.93742C16.8337 2.63742 14.967 0.770752 12.667 0.770752ZM11.8337 4.10409H5.16699V5.77075H11.8337V4.10409Z",fill:"currentColor"}})])},Tt=[];const Lt={},M={};var Mt=u(Lt,Ct,Tt,!1,Et,null,null,null);function Et(t){for(let s in M)this[s]=M[s]}var V=function(){return Mt.exports}(),Bt=function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("div",[e("core-wp-table",{class:{"link-assistant-inner-table":!t.postReport},attrs:{columns:t.columns,rows:t.rows,totals:t.post.links.inboundInternal.totals,"bulk-options":t.bulkOptions,showSearch:!1,showPagination:!t.linksReport,showTableFooter:t.postReport,loading:t.wpTableLoading},on:{"process-bulk-action":t.maybeDoBulkAction,paginate:t.processPagination},scopedSlots:t._u([{key:"post_title",fn:function(n){var i=n.row;return[e("span",[t._v(" "+t._s(i.context.postTitle)+" "),i.context.permalink.replace(/\/$/,"")===t.$aioseo.urls.home?e("span",[t._v("("+t._s(t.strings.frontPage)+")")]):t._e()]),i.context?e("div",{staticClass:"row-actions"},[e("span",{staticClass:"view"},[e("a",{attrs:{href:i.context.permalink,target:"_blank"}},[t._v(t._s(t.strings.viewPost))]),t._v(" | ")]),e("span",{staticClass:"edit"},[e("a",{attrs:{href:i.context.editLink,target:"_blank"}},[t._v(t._s(t.strings.editPost))])])]):t._e()]}},{key:"phrase",fn:function(n){var i=n.row;return[e("link-assistant-phrase",{attrs:{phrase:i.phrase,phraseHtml:i.phrase_html,anchor:i.anchor,url:i.url,clickableAnchor:!0}})]}},{key:"delete",fn:function(n){var i=n.index;return[e("core-tooltip",{attrs:{type:"action"},scopedSlots:t._u([{key:"tooltip",fn:function(){return[t._v(" "+t._s(t.strings.deleteLink)+" ")]},proxy:!0}],null,!0)},[e("svg-trash",{nativeOn:{click:function(o){return t.maybeDoBulkAction({action:"delete",selectedRows:i})}}})],1)]}}])}),t.postReport?t._e():e("div",{staticClass:"links-bottom"},[e("div",{staticClass:"links-bottom-left"},[t.post.links.inboundInternal.rows.length?e("base-button",{attrs:{type:"blue",tag:"button"},nativeOn:{click:function(n){return t.$emit("openSuggestions")}}},[e("svg-link-suggestion"),t._v(" "+t._s(t.strings.outboundSuggestions)+" ")],1):t._e(),t.post.links.inboundInternal.totals.total>5&&t.linksReport?e("div",[e("svg-link-external"),e("a",{staticClass:"link-view",attrs:{href:"#"},on:{click:function(n){return n.preventDefault(),t.openPostReport("inbound-internal")}}},[t._v(" "+t._s(t.seeAllLinks)+" ")])],1):t._e()],1),e("div",{staticClass:"links-bottom-right"},[t.post.links.inboundInternal.rows.length?e("a",{staticClass:"link-delete",on:{click:function(n){return n.preventDefault(),t.maybeDoBulkAction({action:"delete",selectedRows:"all"})}}},[t._v(" "+t._s(t.strings.deleteAllLinks)+" ")]):t._e()])]),e("link-assistant-confirmation-modal",{attrs:{showModal:t.showModal,selectedRows:t.selectedRows,strings:t.modalStrings},on:{doBulkAction:t.doBulkAction,closeModal:function(n){t.showModal=!1}}})],1)},Dt=[];const Ot={components:{CoreTooltip:_,CoreWpTable:f,LinkAssistantConfirmationModal:m,LinkAssistantPhrase:y,SvgLinkExternal:k,SvgLinkSuggestion:V,SvgTrash:b},mixins:[$],data(){return{linkType:"inboundInternal",strings:{deleteAllLinks:this.$t.sprintf("Delete All %1$s Links","Inbound Internal"),outboundSuggestions:this.$t.sprintf("%1$s Link Suggestions","Inbound")}}},computed:{columns(){return[{slug:"post_title",label:"Post Title"},{slug:"phrase",label:"Phrase"},{slug:"delete",width:"50px"}]},seeAllLinks(){return this.$t.sprintf("See All %1$s %2$s Links",this.post.links.inboundInternal.totals.total,"Inbound Internal")}}},E={};var Ht=u(Ot,Bt,Dt,!1,qt,null,null,null);function qt(t){for(let s in E)this[s]=E[s]}var je=function(){return Ht.exports}(),Yt=function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("div",[e("core-wp-table",{class:{"link-assistant-inner-table":!t.postReport},attrs:{columns:t.columns,rows:t.rows,totals:t.post.links.outboundInternal.totals,"bulk-options":t.bulkOptions,showSearch:!1,showPagination:!t.linksReport,showTableFooter:t.postReport,loading:t.wpTableLoading},on:{"process-bulk-action":t.maybeDoBulkAction,paginate:t.processPagination},scopedSlots:t._u([{key:"post_title",fn:function(n){var i=n.row;return[i.context&&i.context.postTitle?e("span",[t._v(" "+t._s(i.context.postTitle)+" "),i.url.replace(/\/$/,"")===t.$aioseo.urls.home?e("span",[t._v("("+t._s(t.strings.frontPage)+")")]):t._e()]):t._e(),!i.context||!i.context.postTitle?e("span",[t._v(" "+t._s(i.url)+" "),i.url.replace(/\/$/,"")===t.$aioseo.urls.home?e("span",[t._v("("+t._s(t.strings.frontPage)+")")]):t._e()]):t._e(),i.context?e("div",{staticClass:"row-actions"},[e("span",{staticClass:"view"},[e("a",{attrs:{href:i.url,target:"_blank"}},[t._v(t._s(t.strings.viewPost))]),t._v(" | ")]),e("span",{staticClass:"edit"},[e("a",{attrs:{href:i.context.editLink,target:"_blank"}},[t._v(t._s(t.strings.editPost))])])]):t._e(),i.context?t._e():e("div",{staticClass:"row-actions"},[e("span",{staticClass:"view"},[e("a",{attrs:{href:i.url,target:"_blank"}},[t._v(t._s(t.strings.openUrl))])])])]}},{key:"phrase",fn:function(n){var i=n.row;return[e("link-assistant-phrase",{attrs:{phrase:i.phrase,phraseHtml:i.phrase_html,anchor:i.anchor,url:i.url,clickableAnchor:!0}})]}},{key:"created",fn:function(n){var i=n.column;return[t._v(" "+t._s(t.$moment.utc(i).tz(t.$moment.tz.guess()).format("MMMM D, YYYY"))+" ")]}},{key:"delete",fn:function(n){var i=n.index;return[e("core-tooltip",{attrs:{type:"action"},scopedSlots:t._u([{key:"tooltip",fn:function(){return[t._v(" "+t._s(t.strings.deleteLink)+" ")]},proxy:!0}],null,!0)},[e("svg-trash",{nativeOn:{click:function(o){return t.maybeDoBulkAction({action:"delete",selectedRows:i})}}})],1)]}}])}),t.postReport?t._e():e("div",{staticClass:"links-bottom"},[e("div",{staticClass:"links-bottom-left"},[t.post.links.outboundInternal.rows.length?e("base-button",{attrs:{type:"blue",tag:"button"},nativeOn:{click:function(n){return t.$emit("openSuggestions")}}},[e("svg-link-suggestion"),t._v(" "+t._s(t.strings.outboundSuggestions)+" ")],1):t._e(),t.post.links.outboundInternal.totals.total>5&&t.linksReport?e("div",[e("svg-link-external"),e("a",{staticClass:"link-view",attrs:{href:"#"},on:{click:function(n){return n.preventDefault(),t.openPostReport("outbound-internal")}}},[t._v(" "+t._s(t.seeAllLinks)+" ")])],1):t._e()],1),e("div",{staticClass:"links-bottom-right"},[t.post.links.outboundInternal.rows.length?e("a",{staticClass:"link-delete",on:{click:function(n){return n.preventDefault(),t.maybeDoBulkAction({action:"delete",selectedRows:"all"})}}},[t._v(" "+t._s(t.strings.deleteAllLinks)+" ")]):t._e()])]),e("link-assistant-confirmation-modal",{attrs:{showModal:t.showModal,selectedRows:t.selectedRows,strings:t.modalStrings},on:{doBulkAction:t.doBulkAction,closeModal:function(n){t.showModal=!1}}})],1)},Nt=[];const Ut={components:{CoreTooltip:_,CoreWpTable:f,LinkAssistantConfirmationModal:m,LinkAssistantPhrase:y,SvgLinkExternal:k,SvgLinkSuggestion:V,SvgTrash:b},mixins:[$],data(){return{linkType:"outboundInternal",strings:{deleteAllLinks:this.$t.sprintf("Delete All %1$s Links","Outbound Internal"),outboundSuggestions:this.$t.sprintf("%1$s Link Suggestions","Outbound"),openUrl:"Open URL"}}},computed:{columns(){return[{slug:"post_title",label:"Post Title / URL"},{slug:"phrase",label:"Phrase"},{slug:"delete",width:"50px"}]},seeAllLinks(){return this.$t.sprintf("See All %1$s %2$s Links",this.post.links.outboundInternal.totals.total,"Outbound Internal")}}},B={};var Ft=u(Ut,Yt,Nt,!1,jt,null,null,null);function jt(t){for(let s in B)this[s]=B[s]}var Ke=function(){return Ft.exports}(),Z={mixins:[z],props:{post:{type:Object,required:!0},postIndex:{type:Number,required:!1},postId:{type:Number,required:!1},filteredSuggestionsOutbound:{type:Array,required:!1},postReport:{type:Boolean,default(){return!1}},linksReport:{type:Boolean,default(){return!1}},metabox:{type:Boolean,default(){return!1}}},beforeMount(){this.$bus.$on("updatingLinks",t=>{this.wpTableLoading=t}),this.pageNumber=this.suggestionType?this.linkAssistant.postReport[this.suggestionType].totals.page:1},data(){return{tableKey:0,pageNumber:1,editablePhraseKey:0,activeSuggestionRow:-1,action:"",showModal:!1,wpTableLoading:!1,selectedRows:[],bulkOptions:[{label:"Add Link",value:"add"},{label:"Description",value:"dismiss"}],strings:{viewPost:"View Post",editPost:"Edit Post",addLink:"Add Link",dismiss:"Dismiss Suggestion"}}},computed:h(d({},w(["linkAssistant","currentPost"])),{rows(){if(!this.metabox)return this.post.links[this.suggestionType].rows;const t=this.pageNumber===1?0:(this.pageNumber-1)*10;return this.suggestionType==="suggestionsOutbound"?this.filteredSuggestionsOutbound.slice(t,t+10):this.post.links[this.suggestionType].rows.slice(t,t+10)},modalStrings(){return this.action==="add"?{areYouSureSingle:"Are you sure you want to add this suggestion?",areYouSureMultiple:"Are you sure you want to add these suggestions?",areYouSureAll:"Are you sure you want to add all suggestions?",actionCannotBeUndone:"This action cannot be undone.",yesSingle:"Yes, I want to add this suggestion",yesMultiple:"Yes, I want to add these suggestions",yesAll:"Yes, I want to add all suggestions",noChangedMind:"No, I changed my mind"}:{areYouSureSingle:"Are you sure you want to dismiss this suggestion?",areYouSureMultiple:"Are you sure you want to dismiss these suggestions?",areYouSureAll:"Are you sure you want to dismiss all suggestions?",actionCannotBeUndone:"This action cannot be undone.",yesSingle:"Yes, I want to dismiss this suggestion",yesMultiple:"Yes, I want to dismiss these suggestions",yesAll:"Yes, I want to dismiss all suggestions",noChangedMind:"No, I changed my mind"}}}),methods:h(d({},U("linkAssistant",["suggestionDismiss","suggestionsBulk","postReportPaginate","postSettingsUpdate"])),{toggleShowMorePhrases(t){if(this.activeSuggestionRow===t){this.activeSuggestionRow=-1;return}this.activeSuggestionRow=t},toggleShowMorePostTitles(t){if(this.activeSuggestionRow===t){this.activeSuggestionRow=-1;return}this.activeSuggestionRow=t},openPostReport(t,s){window.location.href=`#/post-report?postId=${this.postId}&initialTab=${t}&initialSuggestionTab=${s}`},saveModifiedPhrase(t){let s=null;this.linksReport&&(s=this.linkAssistant.linksReport.rows[this.postIndex].links[this.suggestionType].rows[t.postIndex]),this.postReport&&(s=this.linkAssistant.postReport[this.suggestionType].rows[t.postIndex]),this.metabox&&(s=this.currentPost.linkAssistant.links[this.suggestionType].rows[t.postIndex]),s.suggestions[t.phraseIndex].phrase_html!==t.phraseHtml&&(s.suggestions[t.phraseIndex].phrase=t.phrase,s.suggestions[t.phraseIndex].phrase_html=t.phraseHtml,s.suggestions[t.phraseIndex].anchor=t.anchor)},addLink(t,s){let e=null;if(this.suggestionType==="suggestionsInbound"){const i=`editablePhrase${s}`;e=this.$refs[i].selectedPhrase}if(this.suggestionType==="suggestionsOutbound"&&(e=this.selectedPostTitleIndex),e===!1||typeof e=="undefined"){console.error("Couldn't determine index of suggestion.");return}if(this.suggestionType==="suggestionsOutbound"){const i=l(t.suggestions[0].context.permalink),o=l(t.suggestions[e].context.permalink),r=new RegExp(`/${i}/`,"i"),a=t.suggestions[0].phrase_html.replace(r,o);t.suggestions[e].phrase_html=a,t.suggestions[e].anchor=t.suggestions[0].anchor}const n=t.suggestions[e];t.suggestions[e]=t.suggestions[0],t.suggestions[0]=n,this.maybeDoBulkAction({action:"add",selectedRows:t})},maybeDoBulkAction({action:t,selectedRows:s}){s===!1||s===void 0||!t||(this.action=t,this.selectedRows=s,this.showModal=!0)},doBulkAction(){if(this.showModal=!1,!this.selectedRows)return;if(this.action==="dismiss"&&typeof this.selectedRows=="number"){this.doDismissSuggestion(this.selectedRows);return}if(this.selectedRows==="all"){this.$bus.$emit("updatingLinks",!0),this.suggestionsBulk({postIndex:this.postIndex,postId:this.post.ID||this.currentPost.id,action:this.action,suggestionType:this.suggestionType,suggestionRows:"all",linksReport:this.linksReport,postReport:this.postReport}).finally(()=>{this.$bus.$emit("updatingLinks",!1),this.$emit("linksUpdated")});return}let t=null;if(this.linksReport&&(t=this.linkAssistant.linksReport.rows[this.postIndex].links[this.suggestionType].rows),this.postReport&&(t=this.linkAssistant.postReport[this.suggestionType].rows),this.metabox){if(this.action==="add"&&this.suggestionType!=="suggestionsInbound"){if(this.$bus.$emit("updatingLinks",!0),Array.isArray(this.selectedRows))this.selectedRows.forEach(e=>{this.editorAddSuggestion(e)});else{const e=this.selectedRows;this.editorAddSuggestion(e)}this.$bus.$emit("updatingLinks",!1);return}t=this.currentPost.linkAssistant.links[this.suggestionType].rows}const s=[];Array.isArray(this.selectedRows)?this.selectedRows.forEach(e=>{s.push(t[e])}):s.push(this.selectedRows),this.$bus.$emit("updatingLinks",!0),this.suggestionsBulk({postIndex:this.postIndex,postId:this.post.ID||this.currentPost.id,action:this.action,suggestionType:this.suggestionType,suggestionRows:s,linksReport:this.linksReport,postReport:this.postReport}).finally(()=>{this.$bus.$emit("updatingLinks",!1),this.$emit("linksUpdated")})},doDismissSuggestion(t){this.$bus.$emit("updatingLinks",!0),this.suggestionDismiss({postIndex:this.postIndex,postId:this.post.ID||this.currentPost.id,suggestionId:t,linksReport:this.linksReport,postReport:this.postReport}).finally(()=>{this.$bus.$emit("updatingLinks",!1),this.$emit("linksUpdated")})},processPagination(t){this.tableKey++,this.pageNumber=t,!this.metabox&&(this.$bus.$emit("updatingLinks",!0),this.postReportPaginate({page:t,postId:this.post.ID,postIndex:this.postIndex,type:this.suggestionType}).finally(()=>{this.$bus.$emit("updatingLinks",!1)}))},editorAddSuggestion(t){R()&&this.blockEditorAddSuggestion(t),S()&&this.classicEditorAddSuggestion(t)},blockEditorAddSuggestion(t){let s=null,e=null;if(isNaN(t)?this.rows.forEach((g,x)=>{g.suggestions[0].id===t.suggestions[0].id&&(s=g,e=x)}):(e=t,s=this.rows[t]),!s||e===!1)return;this.$bus.$emit("updatingLinks",!0);const n=window.wp.data.select("core/block-editor").getBlocks(),i=s.suggestions[0].original_phrase_html.trim(),o=this.findTargetBlock(n,i);if(!o){this.$bus.$emit("updatingLinks",!1);return}const r=window.wp.data.select("core/block-editor").getBlock(o);if(!r){this.$bus.$emit("updatingLinks",!1);return}const a=l(s.suggestions[0].anchor.trim());let c=new RegExp(`(${a})`,"i");const p=s.suggestions[0].phrase_html.trim(),v=l(i);c=new RegExp(`(${v})`,"i"),window.wp.data.dispatch("core/block-editor").updateBlockAttributes(o,{content:r.attributes.content.replace(c,p)}).then(()=>{this.$delete(this.rows,e)}).catch(g=>{console.error("Couldn't add outbound link:",g)}).finally(()=>{this.postSettingsUpdate({postContent:window.wp.data.select("core/editor").getEditedPostContent(),skipNextRun:!0})})},classicEditorAddSuggestion(t){let s=null,e=null;if(parseInt(t)===!1?this.rows.forEach((g,x)=>{g.suggestions[0].id===t.suggestions[0].id&&(s=g,e=x)}):(e=t,s=this.rows[t]),!s||e===!1)return;this.$bus.$emit("updatingLinks",!0);let n="",i=null,o=null;if(document.querySelector("#wp-content-wrap.tmce-active")?(i=window.tinyMCE.get("content"),n=i.getContent({format:"raw"})):(o=document.querySelector("textarea#content"),n=o?o.value:""),!n){this.$bus.$emit("updatingLinks",!1);return}const r=s.suggestions[0].original_phrase_html.trim(),a=l(r),c=l(s.suggestions[0].anchor.trim());let p=new RegExp(`(${c})`,"i");const v=s.suggestions[0].phrase_html.trim();p=new RegExp(`(${a})`,"i"),n=n.replace(p,v),i?i.setContent(n):o.value=n,this.$delete(this.rows,e),this.postSettingsUpdate({postContent:n,skipNextRun:!0}).finally(()=>{this.$bus.$emit("updatingLinks",!1)})}})},Kt=function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("div",{staticClass:"aioseo-phrase-editor"},[t.context?e("div",{staticClass:"context"},[e("p",[e("strong",{staticClass:"context-label"},[t._v(t._s(t.strings.context)+":")])]),e("p",{domProps:{innerHTML:t._s(t.context)}})]):t._e(),e("base-editor",{ref:"linkEditor",attrs:{"auto-link":{url:t.url,phrase:t.phrase},"show-toolbar":"","allow-tags":""},on:{input:function(n){return t.$emit("input",n)},"selection-change":t.selectionChange}}),e("div",{staticClass:"action-buttons"},[e("base-button",{attrs:{type:"blue",size:"small"},on:{click:function(n){return t.$emit("saveEditor")}}},[t._v(" "+t._s(t.strings.saveChanges)+" ")]),e("base-button",{attrs:{type:"gray",size:"small"},on:{click:function(n){return t.$emit("closeEditor")}}},[t._v(" "+t._s(t.strings.cancel)+" ")])],1)],1)},zt=[];const Vt={components:{BaseEditor:lt},props:{phrase:{type:String,required:!0},url:{type:String,required:!0},context:{type:String,required:!1}},data(){return{strings:{saveChanges:"Save Changes",cancel:"Cancel",context:"Context"}}},mounted(){this.$refs.linkEditor.setPhrase(this.phrase);const t=document.querySelector(".ql-autoLink");t&&(t.innerHTML='<svg viewbox="0 0 18 18"><line class="ql-stroke" x1="7" x2="11" y1="7" y2="11"></line><path class="ql-even ql-stroke" d="M8.9,4.577a3.476,3.476,0,0,1,.36,4.679A3.476,3.476,0,0,1,4.577,8.9C3.185,7.5,2.035,6.4,4.217,4.217S7.5,3.185,8.9,4.577Z"></path><path class="ql-even ql-stroke" d="M13.423,9.1a3.476,3.476,0,0,0-4.679-.36,3.476,3.476,0,0,0,.36,4.679c1.392,1.392,2.5,2.542,4.679.36S14.815,10.5,13.423,9.1Z"></path></svg>',t.classList.add("ql-disabled"))},methods:{getPhrase(){return this.$refs.linkEditor.getPhrase()},getPhraseHtml(){return this.$refs.linkEditor.getPhraseHtml()},getPhraseWithFormats(){return this.$refs.linkEditor.getPhraseWithFormats()},selectionChange({range:t,source:s}){const e=document.querySelector(".ql-autoLink");e&&(!t||!t.length||s!=="user")?e.classList.add("ql-disabled"):e.classList.remove("ql-disabled")}}},D={};var Zt=u(Vt,Kt,zt,!1,Wt,null,null,null);function Wt(t){for(let s in D)this[s]=D[s]}var Gt=function(){return Zt.exports}(),Jt=function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("div",{staticClass:"aioseo-editable-phrase"},[e("div",{staticClass:"domains-report-editable-phrase"},[t.showEditor!==t.rowIndex?e("div",[e("div",{staticClass:"editable-phrase first-phrase",on:{click:function(n){return t.openEditor(t.rowIndex,0)}}},[t.linkSuggestion&&t.showingMorePhrases&&t.suggestionType!=="suggestionsOutbound"?e("input",{attrs:{type:"radio"},domProps:{checked:t.selectedPhrase===0},on:{click:function(n){n.stopPropagation(),t.selectedPhrase=0}}}):t._e(),e("link-assistant-phrase",{class:{hover:t.hoveringOver===0},attrs:{url:t.tooltipUrl(t.row,t.phrases[0]),phrase:t.phrases[0].phrase,phraseHtml:t.phrases[0].phrase_html,anchor:t.phrases[0].anchor},on:{mouseOver:function(n){t.hoveringOver=0},mouseLeave:function(n){t.hoveringOver=-1}},scopedSlots:t._u([{key:"icons",fn:function(){return[e("span",{staticClass:"icons"},[e("svg-pencil"),t.domainsReport?e("svg-trash",{nativeOn:{click:function(n){return function(i){return t.deleteLink(i,t.rowIndex,0)}.apply(null,arguments)}}}):t._e()],1)]},proxy:!0}],null,!1,2783923469)})],1),t.suggestionType!=="suggestionsOutbound"&&1<t.phrases.length&&t.showEditor!==t.rowIndex?e("div",{staticClass:"show-more-phrases"},[e("a",{attrs:{href:"#"},on:{click:function(n){n.preventDefault(),t.$emit("toggleShowMorePhrases",t.rowIndex),t.selectedPhrase=0}}},[e("div",[t._v(t._s(t.viewMorePhrasesLabel))]),e("svg-caret",{class:{rotated:t.showingMorePhrases}})],1)]):t._e(),e("transition-slide",{staticClass:"phrases-list",attrs:{tag:"div",active:t.showingMorePhrases&&t.suggestionType!=="suggestionsOutbound"}},t._l(t.phrases,function(n,i){return e("div",{key:i,staticClass:"editable-phrase-container"},[i?e("div",{staticClass:"editable-phrase selectable-phrase",on:{click:function(o){return t.openEditor(t.rowIndex,i)}}},[t.linkSuggestion&&t.showingMorePhrases?e("input",{attrs:{type:"radio"},domProps:{checked:i===t.selectedPhrase},on:{click:function(o){o.stopPropagation(),t.selectedPhrase=i}}}):t._e(),e("link-assistant-phrase",{class:{hover:i===t.hoveringOver},attrs:{url:t.tooltipUrl(t.row,t.phrases[0]),phrase:n.phrase,phraseHtml:n.phrase_html,anchor:n.anchor},on:{mouseOver:function(o){t.hoveringOver=i},mouseLeave:function(o){t.hoveringOver=-1}},scopedSlots:t._u([{key:"icons",fn:function(){return[e("div",{staticClass:"icons"},[e("svg-pencil"),t.domainsReport?e("svg-trash",{nativeOn:{click:function(o){return function(r){return t.deleteLink(r,t.rowIndex,i)}.apply(null,arguments)}}}):t._e()],1)]},proxy:!0}],null,!0)})],1):t._e()])}),0)],1):t._e(),t.showEditor===t.rowIndex?e("link-assistant-phrase-editor",{ref:"linkEditor",attrs:{value:t.phrases[this.phraseIndex].phrase,phrase:t.phrases[this.phraseIndex].phrase_html,url:t.url,context:t.phraseContext},on:{saveEditor:t.processModifiedPhrase,closeEditor:function(n){t.showEditor=-1,t.hoveringOver=-1}}}):t._e()],1)])},Qt=[];const Xt={components:{LinkAssistantPhrase:y,LinkAssistantPhraseEditor:Gt,SvgCaret:F,SvgPencil:ut,SvgTrash:b,TransitionSlide:j},props:{row:{type:Object,required:!0},rowIndex:{type:Number,default:0},activeRow:{type:Number,default:-1},postIndex:{type:Number,required:!1},suggestionType:{type:String,required:!1},selectedPostTitleIndex:{type:Number,required:!1,default(){return 0}},linkSuggestion:{type:Boolean,default(){return!1}},domainsReport:{type:Boolean,default(){return!1}}},data(){return{phraseIndex:-1,showEditor:-1,hoveringOver:-1,selectedPhrase:0}},computed:h(d({},w(["linkAssistant","currentPost"])),{phrases(){return this.linkSuggestion?this.row.suggestions.slice(0,10):this.row.links.slice(0,10)},url(){return this.domainsReport?this.phrases[this.phraseIndex].url:this.suggestionType==="suggestionsInbound"?this.row.context.permalink:this.suggestionType==="suggestionsOutbound"?this.row.suggestions[this.selectedPostTitleIndex].context.permalink:""},showingMorePhrases(){return 1<this.phrases.length&&this.activeRow===this.rowIndex},viewMorePhrasesLabel(){const t=1<this.phrases.length?this.phrases.length-1:0;return this.$t.sprintf(this.$t._n("%1$d more phrase","%1$d more phrases",t,this.$td),t)},phraseContext(){let t="",s="";if(this.linkSuggestion){const i=this.row.suggestions[this.phraseIndex];t=i.phrase.trim(),s=i.paragraph.trim()}else{const i=this.row.links[this.phraseIndex];t=i.phrase.trim(),s=i.paragraph.trim()}if(t===s)return"";const e=l(t),n=new RegExp(e,"i");return s.match(n)&&(s=s.replace(n,`<strong>${t}</strong>`)),s}}),methods:{tooltipUrl(t,s){return this.domainsReport?s.url:this.suggestionType==="suggestionsInbound"?t.permalink:this.suggestionType==="suggestionsOutbound"&&t.suggestions[this.selectedPostTitleIndex]?t.suggestions[this.selectedPostTitleIndex].context.permalink:""},openEditor(t,s){this.phraseIndex=s,this.showEditor=t},processModifiedPhrase(){this.showEditor=-1,this.hoveringOver=-1;const t=this.$refs.linkEditor.getPhrase(),s=this.$refs.linkEditor.getPhraseHtml(),e=this.$refs.linkEditor.getPhraseWithFormats();let n="";e.ops.forEach(i=>{i.attributes&&i.attributes.link&&(n=n+i.insert)}),!!n&&this.$emit("saveModifiedPhrase",{phrase:t,phraseHtml:s,anchor:n,postIndex:this.rowIndex,phraseIndex:this.phraseIndex})},deleteLink(t,s,e){t.stopPropagation(),t.preventDefault(),this.$emit("delete",{postIndex:s,linkIndex:e})}}},O={};var te=u(Xt,Jt,Qt,!1,ee,null,null,null);function ee(t){for(let s in O)this[s]=O[s]}var W=function(){return te.exports}(),se=function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("div",{staticClass:"aioseo-link-suggestions-Inbound"},[e("core-wp-table",{key:t.tableKey,class:{"link-assistant-inner-table":!t.postReport},attrs:{columns:t.columns,rows:t.rows,totals:t.post.links.suggestionsInbound.totals,"bulk-options":t.bulkOptions,loading:t.wpTableLoading,showSearch:!1,showPagination:!t.linksReport,showTableFooter:t.postReport,initialPageNumber:t.pageNumber},on:{"process-bulk-action":t.maybeDoBulkAction,paginate:t.processPagination},scopedSlots:t._u([{key:"post_title",fn:function(n){var i=n.row;return[e("strong",[e("a",{staticClass:"edit-link",attrs:{href:i.context.permalink,target:"_blank"}},[t._v(t._s(i.context.postTitle))])]),e("div",{staticClass:"row-actions"},[e("span",{staticClass:"view"},[e("a",{attrs:{href:i.context.permalink,target:"_blank"}},[t._v(t._s(t.strings.viewPost))]),t._v(" | ")]),e("span",{staticClass:"edit"},[e("a",{attrs:{href:i.context.editLink,target:"_blank"}},[t._v(t._s(t.strings.editPost))]),t._v(" | ")]),e("span",{staticClass:"dismiss"},[e("a",{attrs:{href:"#"},on:{click:function(o){return o.preventDefault(),t.maybeDoBulkAction({action:"dismiss",selectedRows:i})}}},[t._v(t._s(t.strings.dismiss))])])])]}},{key:"phrase",fn:function(n){var i=n.row,o=n.index;return[e("link-assistant-editable-phrase",{ref:"editablePhrase"+o,attrs:{row:i,rowIndex:o,activeRow:t.activeSuggestionRow,postIndex:t.postIndex,suggestionType:t.suggestionType,linkSuggestion:""},on:{hidePhrases:function(r){t.activeSuggestionRow=-1},toggleShowMorePhrases:t.toggleShowMorePhrases,saveModifiedPhrase:t.saveModifiedPhrase}})]}},{key:"add_link",fn:function(n){var i=n.row,o=n.index;return[e("div",{staticClass:"add-link",on:{click:function(r){return r.preventDefault(),t.addLink(i,o)}}},[e("svg-circle-plus"),e("a",[t._v(t._s(t.strings.addLink))])],1)]}}])}),t.postReport?t._e():e("div",{staticClass:"links-bottom"},[e("div",{staticClass:"links-bottom-left"},[t.post.links.suggestionsInbound.totals.total>5&&t.linksReport?e("div",[e("svg-link-external"),e("a",{staticClass:"link-view",attrs:{href:"#"},on:{click:function(n){return n.preventDefault(),t.openPostReport("link-suggestions","suggestions-inbound")}}},[t._v(" "+t._s(t.seeAllSuggestions)+" ")])],1):t._e()]),e("div",{staticClass:"links-bottom-right"},[t.post.links.suggestionsInbound.rows.length?e("a",{staticClass:"link-delete",on:{click:function(n){return n.preventDefault(),t.maybeDoBulkAction({action:"dismiss",selectedRows:"all"})}}},[t._v(" "+t._s(t.strings.dismissAllSuggestions)+" ")]):t._e()])]),e("link-assistant-confirmation-modal",{attrs:{strings:t.modalStrings,showModal:t.showModal,selectedRows:t.selectedRows},on:{closeModal:function(n){t.showModal=!1},doBulkAction:t.doBulkAction}})],1)},ne=[];const ie={components:{CoreWpTable:f,LinkAssistantConfirmationModal:m,LinkAssistantEditablePhrase:W,SvgCirclePlus:K,SvgLinkExternal:k},mixins:[Z],data(){return{suggestionType:"suggestionsInbound",strings:{dismissAllSuggestions:this.$t.sprintf("Dismiss All %1$s Suggestions","Inbound Internal"),noSuggestions:this.$t.sprintf("You currently don't have any %1$s Suggestions!","Inbound Internal")}}},computed:{columns(){return[{slug:"post_title",label:"Post Title"},{slug:"spacer",width:"30px"},{slug:"phrase",label:"Phrase"},{slug:"add_link",width:"150px"}]},seeAllSuggestions(){return this.$t.sprintf("See All %1$s %2$s Suggestions",this.post.links.suggestionsInbound.totals.total,"Inbound Internal")}}},H={};var oe=u(ie,se,ne,!1,re,null,null,null);function re(t){for(let s in H)this[s]=H[s]}var ae=function(){return oe.exports}(),le=function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("div",{staticClass:"aioseo-post-title-selector"},[e("div",{staticClass:"post-title first-post-title",on:{mouseover:function(n){t.hoveringOver=0},mouseleave:function(n){t.hoveringOver=-1}}},[t.showingMorePostTitles?e("input",{attrs:{type:"radio"},domProps:{checked:t.selectedPostTitleIndex===0},on:{click:function(n){return n.stopPropagation(),t.selectDifferentPostTitle(0)}}}):t._e(),e("span",{staticClass:"post-title-text"},[t._v(t._s(t.postTitles[0]))]),e("div",{staticClass:"row-actions",class:{hover:t.hoveringOver===0}},[e("span",{staticClass:"view"},[e("a",{attrs:{href:t.row.suggestions[0].context.permalink,target:"_blank"}},[t._v(t._s(t.strings.viewPost))]),t._v(" | ")]),e("span",{staticClass:"edit"},[e("a",{attrs:{href:t.row.suggestions[0].context.editLink,target:"_blank"}},[t._v(t._s(t.strings.editPost))])])])]),1<t.postTitles.length?e("div",{staticClass:"show-more-post-titles"},[e("a",{attrs:{href:"#"},on:{click:function(n){n.preventDefault(),t.$emit("toggleShowMorePhrases",t.rowIndex),t.selectDifferentPostTitle(0)}}},[e("div",[t._v(t._s(t.viewMorePostTitlesLabel))]),e("svg-caret",{class:{rotated:t.showingMorePostTitles}})],1)]):t._e(),e("transition-slide",{staticClass:"post-titles-list",attrs:{tag:"div",active:t.showingMorePostTitles}},t._l(t.postTitles,function(n,i){return e("div",{key:i,staticClass:"post-title post-title-container"},[i?e("div",{staticClass:"selectable-post-title",on:{mouseover:function(o){t.hoveringOver=i},mouseleave:function(o){t.hoveringOver=-1}}},[t.showingMorePostTitles?e("input",{attrs:{type:"radio"},domProps:{checked:i===t.selectedPostTitleIndex},on:{click:function(o){return o.stopPropagation(),t.selectDifferentPostTitle(i)}}}):t._e(),e("span",{staticClass:"post-title-text"},[t._v(t._s(t.postTitles[i]))]),e("div",{staticClass:"row-actions",class:{hover:i===t.hoveringOver}},[e("span",{staticClass:"view"},[e("a",{attrs:{href:t.row.suggestions[i].context.permalink,target:"_blank"}},[t._v(t._s(t.strings.viewPost))]),t._v(" | ")]),e("span",{staticClass:"edit"},[e("a",{attrs:{href:t.row.suggestions[i].context.editLink,target:"_blank"}},[t._v(t._s(t.strings.editPost))])])])]):t._e()])}),0)],1)},ue=[];const ce={components:{SvgCaret:F,TransitionSlide:j},props:{row:{type:Object,required:!0},rowIndex:{type:Number,default:0},activeRow:{type:Number,default:-1},postIndex:{type:Number,required:!1},suggestionType:{type:String,required:!1}},data(){return{selectedPostTitleIndex:-1,hoveringOver:-1,strings:{viewPost:"View Post",editPost:"Edit Post"}}},computed:h(d({},w(["linkAssistant","currentPost"])),{postTitles(){const t=[];return this.row.suggestions.forEach(s=>{t.includes[s.context.postTitle]||t.push(s.context.postTitle)}),t.slice(0,10)},showingMorePostTitles(){return 1<this.postTitles.length&&this.activeRow===this.rowIndex},viewMorePostTitlesLabel(){const t=1<this.postTitles.length?this.postTitles.length-1:0;return this.$t.sprintf(this.$t._n("%1$d more post","%1$d more posts",t,this.$td),t)}}),methods:{selectDifferentPostTitle(t){this.selectedPostTitleIndex!==t&&(this.selectedPostTitleIndex=t,this.$emit("postTitleIndexChanged",t))}}},q={};var de=u(ce,le,ue,!1,pe,null,null,null);function pe(t){for(let s in q)this[s]=q[s]}var he=function(){return de.exports}(),ge=function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("div",{staticClass:"aioseo-link-suggestions-outbound"},[e("core-wp-table",{key:t.tableKey,class:{"link-assistant-inner-table":!t.postReport},attrs:{columns:t.columns,rows:t.rows,totals:t.post.links.suggestionsOutbound.totals,"bulk-options":t.bulkOptions,loading:t.wpTableLoading,showSearch:!1,showPagination:!t.linksReport,showTableFooter:t.postReport,initialPageNumber:t.pageNumber},on:{"process-bulk-action":t.maybeDoBulkAction,paginate:t.processPagination},scopedSlots:t._u([{key:"post_title",fn:function(n){var i=n.row,o=n.index;return[e("link-assistant-post-title-selector",{ref:"postTitleSelector"+o,attrs:{row:i,rowIndex:o,activeRow:t.activeSuggestionRow,postIndex:t.postIndex,suggestionType:t.suggestionType,linkSuggestion:""},on:{hidePhrases:function(r){t.activeSuggestionRow=-1},toggleShowMorePhrases:t.toggleShowMorePhrases,saveModifiedPhrase:t.saveModifiedPhrase,postTitleIndexChanged:function(r){return t.selectedPostTitleIndex=r}}})]}},{key:"phrase",fn:function(n){var i=n.row,o=n.index;return[e("link-assistant-editable-phrase",{attrs:{row:i,rowIndex:o,activeRow:t.activeSuggestionRow,postIndex:t.postIndex,suggestionType:t.suggestionType,selectedPostTitleIndex:t.selectedPostTitleIndex,linkSuggestion:""},on:{hidePhrases:function(r){t.activeSuggestionRow=-1},saveModifiedPhrase:t.saveModifiedPhrase}}),e("div",{staticClass:"row-actions"},[e("span",{staticClass:"dismiss"},[e("a",{attrs:{href:"#"},on:{click:function(r){return r.preventDefault(),t.maybeDoBulkAction({action:"dismiss",selectedRows:i})}}},[t._v(t._s(t.strings.dismiss))])])])]}},{key:"add_link",fn:function(n){var i=n.row,o=n.index;return[e("div",{staticClass:"add-link",on:{click:function(r){return r.preventDefault(),t.addLink(i,o)}}},[e("svg-circle-plus"),e("a",[t._v(t._s(t.strings.addLink))])],1)]}}])}),t.postReport?t._e():e("div",{staticClass:"links-bottom"},[e("div",{staticClass:"links-bottom-left"},[t.post.links.suggestionsOutbound.totals.total>5&&t.linksReport?e("div",[e("svg-link-external"),e("a",{staticClass:"link-view",attrs:{href:"#"},on:{click:function(n){return n.preventDefault(),t.openPostReport("link-suggestions","suggestions-outbound")}}},[t._v(" "+t._s(t.seeAllSuggestions)+" ")])],1):t._e()]),e("div",{staticClass:"links-bottom-right"},[t.filteredSuggestionsOutbound.length?e("a",{staticClass:"link-delete",on:{click:function(n){return n.preventDefault(),t.maybeDoBulkAction({action:"dismiss",selectedRows:"all"})}}},[t._v(" "+t._s(t.strings.dismissAllSuggestions)+" ")]):t._e()])]),e("link-assistant-confirmation-modal",{attrs:{strings:t.modalStrings,showModal:t.showModal,selectedRows:t.selectedRows},on:{closeModal:function(n){t.showModal=!1},doBulkAction:t.doBulkAction}})],1)},fe=[];const ke={components:{CoreWpTable:f,LinkAssistantConfirmationModal:m,LinkAssistantEditablePhrase:W,LinkAssistantPostTitleSelector:he,SvgCirclePlus:K,SvgLinkExternal:k},mixins:[Z],data(){return{suggestionType:"suggestionsOutbound",selectedPostTitleIndex:0,strings:{dismissAllSuggestions:this.$t.sprintf("Dismiss All %1$s Suggestions","Outbound Internal"),noSuggestions:this.$t.sprintf("You currently don't have any %1$s Suggestions!","Outbound Internal")}}},computed:{columns(){return[{slug:"phrase",label:"Phrase"},{slug:"spacer",width:"30px"},{slug:"post_title",label:"Post Title"},{slug:"add_link",width:"150px"}]},seeAllSuggestions(){return this.$t.sprintf("See All %1$s %2$s Suggestions",this.post.links.suggestionsOutbound.totals.total,"Outbound Internal")}}},Y={};var me=u(ke,ge,fe,!1,ve,null,null,null);function ve(t){for(let s in Y)this[s]=Y[s]}var _e=function(){return me.exports}(),be=function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("div",{staticClass:"aioseo-link-suggestions"},[t.internalOptions.internal.dismissedAlerts.suggestions?t._e():e("core-alert",{staticClass:"description",attrs:{type:"blue","show-close":""},on:{"close-alert":t.dismissAlert}},[e("span",{domProps:{innerHTML:t._s(t.strings.description)}})]),e("core-main-tabs",{key:t.tabsKey,attrs:{internal:"",tabs:t.tabs,active:t.activeTab,showSaveButton:!1},on:{changed:t.processChangeTab},scopedSlots:t._u([{key:"md-tab-icon",fn:function(n){var i=n.tab;return[e(i.icon,{tag:"component",class:[{warning:i.data.warning}]})]}}])}),e("div",{staticClass:"link-suggestions-container"},[e("keep-alive",[t.activeTab==="suggestions-outbound"?e("outbound",{attrs:{post:t.post,postIndex:t.postIndex,postId:t.postId,filteredSuggestionsOutbound:t.filteredSuggestionsOutbound,linksReport:t.linksReport,postReport:t.postReport,metabox:t.metabox},on:{linksUpdated:function(n){t.tabsKey++,t.$emit("linksUpdated")}}}):t._e()],1),e("keep-alive",[t.activeTab==="suggestions-inbound"?e("inbound",{attrs:{post:t.post,postIndex:t.postIndex,postId:t.postId,linksReport:t.linksReport,postReport:t.postReport,metabox:t.metabox},on:{linksUpdated:function(n){t.tabsKey++,t.$emit("linksUpdated")}}}):t._e()],1)],1)],1)},we=[];const $e={components:{CoreAlert:it,CoreMainTabs:ot,Inbound:ae,Outbound:_e,SvgLinkInternalInbound:et,SvgLinkInternalOutbound:st},mixins:[$],props:{filteredSuggestionsOutbound:{type:Array,required:!0},initialTab:{type:String,required:!1},showAlert:{type:Boolean,default(){return!1}}},data(){return{tabsKey:0,activeTab:"suggestions-inbound",strings:{description:this.$t.sprintf("Below you can add inbound and outbound internal links based on %1$s's smart suggestions. These suggestions are generated in the background, which requires some time to complete. %2$s","AIOSEO",this.$links.getDocLink(this.$constants.GLOBAL_STRINGS.learnMore,"linkAssistant",!0))}}},computed:h(d(d({},w("linkAssistant",["internalOptions"])),nt("linkAssistant",["getLinksReportCounts"])),{tabs(){return[{slug:"suggestions-inbound",icon:"svg-link-internal-inbound",name:this.$t.sprintf("%1$s %2$s",this.metabox?this.post.links.suggestionsInbound.totals.total:this.getLinksReportCounts[this.postIndex].suggestionsInbound,"Inbound Internal Suggestions")},{slug:"suggestions-outbound",icon:"svg-link-internal-outbound",name:this.$t.sprintf("%1$s %2$s",this.metabox?this.filteredSuggestionsOutbound.length:this.getLinksReportCounts[this.postIndex].suggestionsOutbound,"Outbound Internal Suggestions")}]}}),methods:{processChangeTab(t){this.activeTab=t,this.$emit("suggestionsTabChanged",t)},dismissAlert(){this.internalOptions.internal.dismissedAlerts.suggestions=!0,this.$http.get(this.$links.restUrl("link-assistant/data/dismiss-alert")).catch(t=>console.log("Could not dismiss suggestions alert:",t))}},beforeMount(){this.initialTab&&(this.activeTab=this.initialTab)}},N={};var ye=u($e,be,we,!1,xe,null,null,null);function xe(t){for(let s in N)this[s]=N[s]}var ze=function(){return ye.exports}();export{Ue as L,V as S,Fe as a,je as b,Ke as c,ze as d,Ne as e,m as f,W as g};
